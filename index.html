<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3CradialGradient id='glow' cx='30%25' cy='30%25'%3E%3Cstop offset='0%25' stop-color='%23c084fc'/%3E%3Cstop offset='70%25' stop-color='%237c3aed'/%3E%3Cstop offset='100%25' stop-color='%234c1d95'/%3E%3C/radialGradient%3E%3C/defs%3E%3Ccircle cx='32' cy='32' r='28' fill='url(%23glow)' stroke='%23e9d5ff' stroke-width='3' opacity='0.95'/%3E%3Ccircle cx='32' cy='32' r='22' fill='%231e1b4b' opacity='0.6'/%3E%3Cg transform='translate(18,28) scale(0.8)' opacity='0.7'%3E%3Crect x='0' y='0' width='28' height='8' rx='2' fill='%23ddd'/%3E%3Crect x='2' y='10' width='5' height='5' rx='1' fill='%23555'/%3E%3Crect x='9' y='10' width='5' height='5' rx='1' fill='%23555'/%3E%3Crect x='16' y='10' width='5' height='5' rx='1' fill='%23555'/%3E%3Crect x='23' y='10' width='5' height='5' rx='1' fill='%23555'/%3E%3Crect x='6' y='16' width='16' height='5' rx='1' fill='%234ade80'/%3E%3C/g%3E%3Ccircle cx='22' cy='20' r='8' fill='%23fff' opacity='0.4'/%3E%3Ccircle cx='20' cy='18' r='4' fill='%23fff' opacity='0.7'/%3E%3C/svg%3E">
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            --panel-bg: rgba(255, 255, 255, 0.85);
            --border: #cbd5e1;
            --text: #1e293b;
            --text-muted: #64748b;
            --primary: #6366f1;
            --primary-light: #818cf8;
            --success: #10b981;
            --danger: #ef4444;
            --hover-bg: #f8fafc;
            --input-bg: white;
            --shadow: 0 4px 20px rgba(0,0,0,0.08);
            --shadow-hover: 0 6px 25px rgba(0,0,0,0.12);
        }

        [data-theme="dark"] {
            --bg-gradient: linear-gradient(135deg, #0f172a, #1e293b);
            --panel-bg: rgba(30, 41, 59, 0.8);
            --border: #334155;
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --primary: #818cf8;
            --primary-light: #a5b4fc;
            --success: #34d399;
            --danger: #f87171;
            --hover-bg: #1e293b;
            --input-bg: #0f172a;
            --shadow: 0 4px 20px rgba(0,0,0,0.3);
            --shadow-hover: 0 6px 25px rgba(0,0,0,0.4);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--bg-gradient);
            color: var(--text);
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--panel-bg);
            border: 1px solid var(--border);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            box-shadow: var(--shadow);
            font-size: 18px;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: rotate(20deg);
            background: var(--hover-bg);
        }

        .reset-button {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--panel-bg);
            border: 1px solid var(--border);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            box-shadow: var(--shadow);
            font-size: 18px;
            transition: all 0.3s;
        }

        .reset-button:hover {
            transform: rotate(20deg);
            background: var(--hover-bg);
        }

        .top-container {
            max-width: 1800px;
            margin: 0 auto 20px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 1200px) {
            .top-container {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: var(--panel-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .panel h3 {
            margin-top: 0;
            color: var(--primary);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        textarea, input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            background: var(--input-bg);
            color: var(--text);
            resize: vertical;
        }

        textarea {
            height: 160px;
        }

        textarea:focus, input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .copy-btn, .enhance-btn, .help-btn, .icon-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--input-bg);
            border: 1px solid var(--border);
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            transition: all 0.2s;
            color: var(--text);
            text-decoration: none;
            font-size: 18px;
        }
        
        .icon-btn {
            right: 70px;
            width: 38px;
            height: 38px;
            padding: 0;
            justify-content: center;
            font-size: 18px;
        }

        .help-btn {
            right: 120px;
            background: var(--hover-bg);
        }

        .enhance-btn {
            position: static;
            width: 100%;
            margin-top: 10px;
            background: var(--primary);
            color: white;
            border: none;
        }

        .copy-btn:hover, .enhance-btn:hover, .help-btn:hover, .icon-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .examples-container {
            background: var(--panel-bg);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 8px 0;
        }

        .section-header h3,
        .subcategory-header h4 {
            margin: 0;
            color: var(--text);
        }

        .toggle-icon {
            font-size: 18px;
            transition: transform 0.3s;
            color: var(--text-muted);
        }

        .toggle-icon.collapsed {
            transform: rotate(-90deg);
        }

        .section-content,
        .subcategory-content {
            margin-top: 16px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, opacity 0.4s ease;
            opacity: 0;
        }

        .section-content.expanded,
        .subcategory-content.expanded {
            max-height: 1000px;
            opacity: 1;
        }

        .styles-content,
        .artistic-content {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .styles-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .style-option {
            display: flex;
            align-items: center;
            white-space: nowrap;
            background: var(--input-bg);
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid var(--border);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text);
        }

        .style-option:hover {
            background: var(--hover-bg);
            border-color: var(--primary);
        }

        .style-option input {
            margin-right: 6px;
        }

        .search-box {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            background: var(--input-bg);
            color: var(--text);
        }

        .quality-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
            margin-top: 12px;
        }

        .quality-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text);
            font-size: 14px;
        }

        .example-btn {
            display: inline-block;
            background: var(--hover-bg);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: background 0.2s;
            color: var(--text);
            margin: 4px 4px 0 0;
            white-space: nowrap;
        }

        .example-btn:hover {
            background: var(--border);
        }

        .btn-refresh {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            width: 36px;
            height: 36px;
            padding: 0;
            font-size: 18px;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-refresh:hover {
            background: var(--primary-light);
        }

        .control-container {
            max-width: 1800px;
            margin: 0 auto 20px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        @media (max-width: 1200px) {
            .control-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 800px) {
            .control-container {
                grid-template-columns: 1fr;
            }
        }

        .styles-container,
        .quality-container,
        .artistic-container {
            background: var(--panel-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .history-container {
            background: var(--panel-bg);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow);
        }

        .history-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 12px;
        }

        @media (max-width: 1000px) {
            .history-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .history-grid {
                grid-template-columns: 1fr;
            }
        }

        .history-item {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 13px;
            cursor: pointer;
            transition: background 0.2s;
            color: var(--text);
            background: var(--input-bg);
        }

        .history-item:hover {
            background: var(--hover-bg);
        }

        .history-actions {
            margin-top: 16px;
            text-align: right;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .btn-clear {
            background: var(--danger);
            color: white;
            width: 50px;
            height: 50px;
            padding: 0;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-clear:hover {
            opacity: 0.9;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
            z-index: 1000;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .api-settings {
            margin-top: 12px;
            padding: 12px 0;
            border-top: 1px solid var(--border);
        }

        .api-settings label {
            display: block;
            margin: 8px 0 4px;
            font-size: 13px;
            color: var(--text);
        }
        
        .enhance-mode-container {
            margin-bottom: 10px;
        }

        .api-key-container {
            position: relative;
        }

        .remember-key-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 6px;
            font-size: 12px;
            color: var(--text-muted);
            cursor: pointer;
        }

        .remember-key-checkbox input[type="checkbox"] {
            width: auto;
            cursor: pointer;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
        }

        .modal-content {
            background: var(--panel-bg);
            margin: 5% auto;
            padding: 25px;
            border-radius: 16px;
            width: 90%;
            max-width: 800px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
        }

        .close-modal:hover {
            color: var(--text);
        }

        .modal h3 {
            margin-top: 0;
            color: var(--primary);
        }

        .modal ol {
            padding-left: 20px;
            margin: 15px 0;
        }

        .modal li {
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .modal a {
            color: var(--primary);
            text-decoration: underline;
        }

        .modal a:hover {
            color: var(--primary-light);
        }

        .artistic-category-level-1 {
            margin-left: 10px;
            padding-left: 10px;
            border-left: 2px solid var(--border);
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .artistic-category-level-2 {
            margin-left: 10px;
            padding-left: 10px;
            border-left: 1px dashed var(--border);
            margin-top: 8px;
            margin-bottom: 8px;
        }

        .artistic-category-level-1 > .section-header h3 {
            color: var(--text);
        }
        .artistic-category-level-2 > .section-header h4 {
            color: var(--text-muted);
        }

        .artistic-counter {
            display: inline-block;
            margin-left: 8px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background: var(--success);
            color: white;
            transition: all 0.3s;
        }

        .artistic-counter.exceeded {
            background: var(--danger);
            animation: pulse 0.5s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .toast {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: var(--danger);
            color: white;
            padding: 14px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1001;
            max-width: 320px;
            font-size: 14px;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .preset-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        .preset-btn {
            padding: 0;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preset-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .preset-btn.secondary {
            background: var(--hover-bg);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .preset-btn.secondary:hover {
            background: var(--border);
        }

        .preset-list {
            margin-top: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        .preset-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 6px 0;
            background: var(--input-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .preset-item:hover {
            background: var(--hover-bg);
            border-color: var(--primary);
        }

        .preset-item-name {
            font-weight: 600;
            color: var(--text);
            flex: 1;
        }

        .preset-item-actions {
            display: flex;
            gap: 6px;
        }

        .preset-item-btn {
            padding: 4px 10px;
            font-size: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .preset-item-btn.load {
            background: var(--success);
            color: white;
        }

        .preset-item-btn.delete {
            background: var(--danger);
            color: white;
        }

        .preset-item-btn:hover {
            opacity: 0.8;
            transform: scale(1.05);
        }

        .random-prompt-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0;
            height: 50px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 12px;
            width: 100%;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .random-prompt-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .random-prompt-btn:active {
            transform: translateY(0);
        }

        .preset-modal-content {
            background: var(--panel-bg);
            margin: 10% auto;
            padding: 25px;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        }

        .preset-modal-content input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--text);
        }

        .preset-modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .preset-modal-actions button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .preset-modal-actions .btn-save {
            background: var(--success);
            color: white;
        }

        .preset-modal-actions .btn-cancel {
            background: var(--hover-bg);
            color: var(--text);
        }
        
        .translation-result {
            margin-top: 15px;
            padding: 15px;
            background: var(--hover-bg);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            white-space: pre-wrap;
        }

        .translation-copy-btn {
            margin-top: 10px;
            padding: 8px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s;
        }
        
        .translation-copy-btn:hover {
            background: var(--primary-light);
        }

        /* === –ù–û–í–´–ô –ë–õ–û–ö: –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π === */
        .image-recognition-container {
            background: var(--panel-bg);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow);
        }

        .image-upload-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            margin: 15px 0;
            background: var(--input-bg);
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-upload-area:hover {
            border-color: var(--primary);
            background: var(--hover-bg);
        }

        .image-upload-area.dragging {
            border-color: var(--primary);
            background: var(--primary-light);
            opacity: 0.8;
        }

        .image-preview {
            max-width: 100%;
            max-height: 400px;
            margin: 15px auto;
            display: block;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .hf-token-container {
            margin: 15px 0;
        }

        .image-prompt-result {
            margin-top: 15px;
            padding: 15px;
            background: var(--hover-bg);
            border-radius: 8px;
            border-left: 4px solid var(--success);
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .image-analyze-btn {
            width: 100%;
            padding: 12px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 10px;
        }

        .image-analyze-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        .image-analyze-btn:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: none;
        }

        .image-prompt-copy-btn {
            margin-top: 10px;
            padding: 10px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            font-size: 14px;
            transition: all 0.2s;
        }

        .image-prompt-copy-btn:hover {
            background: var(--primary-light);
        }

        .hf-help-btn {
            display: inline-block;
            margin-left: 10px;
            padding: 4px 12px;
            background: var(--hover-bg);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .hf-help-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* === –ö–û–ù–ï–¶ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ —Å—Ç–∏–ª–µ–π === */

    </style>
</head>
<body>
    <div class="theme-toggle" id="theme-toggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</div>
    <div class="reset-button" id="reset-button" title="–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã">üîÑ</div>

    <div class="top-container">
        <div class="panel">
            <h3>üìù –í–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–æ–º</h3>
            <textarea id="input" placeholder="–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä: '–ö–æ—Ç –Ω–∞ –∫—Ä—ã—à–µ –ø–æ–¥ –ª—É–Ω–æ–π'"></textarea>

            <div class="examples-container">
                <div class="section-header" style="padding: 0; margin-bottom: 12px;">
                    <h3>‚ú® –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–º–ø—Ç–æ–≤</h3>
                    <button class="btn-refresh" onclick="renderRandomExamples()" title="–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã">üîÑ</button>
                </div>
                <div id="examples-list"></div>
                <button class="random-prompt-btn" onclick="generateRandomPrompt()" title="–°–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ–º–ø—Ç">üé≤</button>
            </div>
        </div>

        <div class="panel">
            <h3>üéØ –ì–æ—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç</h3>
            <button class="icon-btn" onclick="translateBack('output')" title="–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π">üåê</button>
            <button id="copy-btn" class="copy-btn" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç">üìã</button>
            <textarea id="output" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –ø—Ä–æ–º–ø—Ç..."></textarea>
        </div>

        <div class="panel">
            <h3>‚ú® –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç</h3>
            <button class="icon-btn" onclick="translateBack('enhanced-output')" title="–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π">üåê</button>
            <button id="copy-enhanced-btn" class="copy-btn" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç">üìã</button>
            <button id="help-btn" class="help-btn" onclick="openHelpModal()" title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è">‚ùì</button>
            <textarea id="enhanced-output" readonly placeholder="–ù–∞–∂–º–∏—Ç–µ '–£–ª—É—á—à–∏—Ç—å' –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏..."></textarea>

            <div class="api-settings">
                <div class="api-key-container">
                    <label for="api-key">üîë –í–∞—à API-–∫–ª—é—á Groq:</label>
                    <input type="password" id="api-key" placeholder="gsk_...">
                    <label class="remember-key-checkbox">
                        <input type="checkbox" id="remember-key">
                        <span>–ó–∞–ø–æ–º–Ω–∏—Ç—å –∫–ª—é—á –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏</span>
                    </label>
                </div>

                <label for="model-input">üß† –ú–æ–¥–µ–ª—å (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è):</label>
                <input type="text" id="model-input" placeholder="llama3-8b-8192">
                
                <div class="enhance-mode-container">
                    <label for="enhance-mode">üé® –†–µ–∂–∏–º —É–ª—É—á—à–µ–Ω–∏—è:</label>
                    <select id="enhance-mode">
                        <option value="artistic">–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ (Artistic)</option>
                        <option value="technical">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ (Technical)</option>
                        <option value="cinematic">–ö–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω–æ (Cinematic)</option>
                        <option value="anime">–ê–Ω–∏–º–µ-—Å—Ç–∏–ª—å (Anime)</option>
                        <option value="minimalist">–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ (Minimalist)</option>
                    </select>
                </div>
            </div>

            <button id="enhance-btn" class="enhance-btn" title="–£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–º–ø—Ç">üé®</button>
        </div>
    </div>

    <div class="control-container">
        <div class="styles-container">
            <div class="section-header" onclick="toggleSection('styles')">
                <h3>üé® –°—Ç–∏–ª–∏ (–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω)</h3>
                <span class="toggle-icon" id="styles-toggle">‚ñº</span>
            </div>
            <input type="text" class="search-box" id="style-search" placeholder="–ü–æ–∏—Å–∫ —Å—Ç–∏–ª—è...">
            <div class="section-content styles-content" id="styles-content"></div>
        </div>

        <div class="quality-container">
            <div class="section-header" onclick="toggleSection('quality')">
                <h3>üéõÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
                <span class="toggle-icon" id="quality-toggle">‚ñº</span>
            </div>
            <div class="section-content" id="quality-content">
                <div class="quality-grid">
                    <div class="quality-group">
                        <label>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ</label>
                        <select id="resolution">
                            <option value="">–ù–µ—Ç</option>
                            <option value="4K resolution">4K</option>
                            <option value="8K resolution">8K</option>
                            <option value="Ultra HD">Ultra HD</option>
                            <option value="Full HD">Full HD</option>
                            <option value="1440p">1440p</option>
                            <option value="1080p">1080p</option>
                            <option value="HD">HD</option>
                        </select>
                    </div>
                    <div class="quality-group">
                        <label>–û—Å–≤–µ—â–µ–Ω–∏–µ</label>
                        <select id="lighting">
                            <option value="">–ù–µ—Ç</option>
                            <option value="cinematic lighting">–ö–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ</option>
                            <option value="dramatic lighting">–î—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–æ–µ</option>
                            <option value="soft lighting">–ú—è–≥–∫–æ–µ</option>
                            <option value="studio lighting">–°—Ç—É–¥–∏–π–Ω–æ–µ</option>
                            <option value="natural lighting">–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ</option>
                            <option value="backlighting">–ö–æ–Ω—Ç—Ä–æ–≤–æ–µ</option>
                            <option value="side lighting">–ë–æ–∫–æ–≤–æ–µ</option>
                            <option value="golden hour lighting">–ó–æ–ª–æ—Ç–æ–π —á–∞—Å</option>
                            <option value="twilight lighting">–°—É–º–µ—Ä–∫–∏</option>
                            <option value="neon lighting">–ù–µ–æ–Ω–æ–≤–æ–µ</option>
                        </select>
                    </div>
                    <div class="quality-group">
                        <label>–¶–≤–µ—Ç–∞</label>
                        <select id="colors">
                            <option value="">–ù–µ—Ç</option>
                            <option value="vibrant colors">–Ø—Ä–∫–∏–µ</option>
                            <option value="muted colors">–ü—Ä–∏–≥–ª—É—à–µ–Ω–Ω—ã–µ</option>
                            <option value="pastel colors">–ü–∞—Å—Ç–µ–ª—å–Ω—ã–µ</option>
                            <option value="monochrome">–ú–æ–Ω–æ—Ö—Ä–æ–º</option>
                            <option value="warm tones">–¢—ë–ø–ª—ã–µ —Ç–æ–Ω–∞</option>
                            <option value="cool tones">–•–æ–ª–æ–¥–Ω—ã–µ —Ç–æ–Ω–∞</option>
                            <option value="high contrast colors">–ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–µ</option>
                            <option value="earth tones">–ó–µ–º–ª—è–Ω—ã–µ —Ç–æ–Ω–∞</option>
                            <option value="retro color palette">–†–µ—Ç—Ä–æ –ø–∞–ª–∏—Ç—Ä–∞</option>
                        </select>
                    </div>
                    <div class="quality-group">
                        <label>–§–æ–∫—É—Å</label>
                        <select id="focus">
                            <option value="">–ù–µ—Ç</option>
                            <option value="sharp focus">–†–µ–∑–∫–∏–π</option>
                            <option value="soft focus">–ú—è–≥–∫–∏–π</option>
                            <option value="bokeh">–ë–æ–∫–µ</option>
                            <option value="deep depth of field">–ì–ª—É–±–æ–∫–∞—è —Ä–µ–∑–∫–æ—Å—Ç—å</option>
                            <option value="selective focus">–°–µ–ª–µ–∫—Ç–∏–≤–Ω—ã–π —Ñ–æ–∫—É—Å</option>
                            <option value="blurred background">–†–∞–∑–º—ã—Ç—ã–π —Ñ–æ–Ω</option>
                        </select>
                    </div>
                    <div class="quality-group" style="grid-column: span 2;">
                        <label>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</label>
                        <select id="detail">
                            <option value="">–ù–µ—Ç</option>
                            <option value="highly detailed">–í—ã—Å–æ–∫–∞—è</option>
                            <option value="ultra detailed">–£–ª—å—Ç—Ä–∞</option>
                            <option value="photorealistic">–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è</option>
                            <option value="intricate details">–ò–∑—ã—Å–∫–∞–Ω–Ω–∞—è</option>
                            <option value="minimalist detail">–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è</option>
                            <option value="low detail">–ù–∏–∑–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div class="artistic-container">
            <div class="section-header" onclick="toggleSection('artistic')">
                <h3>üñºÔ∏è –•—É–¥–æ–∂. —ç–ª–µ–º–µ–Ω—Ç—ã (–¥–æ 5)<span class="artistic-counter" id="artistic-counter">0/5</span></h3>
                <span class="toggle-icon" id="artistic-toggle">‚ñº</span>
            </div>
            <input type="text" class="search-box" id="artistic-search" placeholder="–ü–æ–∏—Å–∫...">
            <div class="section-content artistic-content" id="artistic-content"></div>
        </div>
    </div>

    <div class="history-container">
        <div class="section-header" onclick="toggleSection('history')">
            <h3>üïí –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 60)</h3>
            <span class="toggle-icon" id="history-toggle">‚ñº</span>
        </div>
        <div class="section-content" id="history-content">
            <div class="history-grid" id="history-grid"></div>
            <div class="history-actions">
                <button class="btn btn-clear" onclick="clearHistory()" title="–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é">üóëÔ∏è</button>
            </div>
        </div>
    </div>

    <!-- === –ù–û–í–´–ô –ë–õ–û–ö: –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π === -->
    <div class="image-recognition-container">
        <div class="section-header" onclick="toggleSection('image-recognition')">
            <h3>üñºÔ∏è –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (Hugging Face LLaVA)</h3>
            <span class="toggle-icon collapsed" id="image-recognition-toggle">‚ñº</span>
        </div>
        <div class="section-content" id="image-recognition-content">
            <p style="font-size: 14px; color: var(--text-muted); margin-bottom: 15px;">
                –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Ö–æ–∂–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
            </p>

            <div class="hf-token-container">
                <label for="hf-token">üîë Hugging Face API —Ç–æ–∫–µ–Ω:
                    <button class="hf-help-btn" onclick="openHFHelpModal()">‚ùì –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</button>
                </label>
                <input type="password" id="hf-token" placeholder="hf_...">
                <label class="remember-key-checkbox">
                    <input type="checkbox" id="remember-hf-token">
                    <span>–ó–∞–ø–æ–º–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏</span>
                </label>
            </div>

            <div class="image-upload-area" id="image-upload-area">
                <p style="font-size: 16px; margin: 0;">üìÅ –ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—é–¥–∞</p>
                <p style="font-size: 12px; color: var(--text-muted); margin: 5px 0 0;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è JPG, PNG, WebP</p>
                <input type="file" id="image-file-input" accept="image/*" style="display: none;">
            </div>

            <div id="image-preview-container" style="display: none;">
                <img id="image-preview" class="image-preview" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä">
            </div>

            <button class="image-analyze-btn" id="analyze-image-btn" disabled>
                <span id="analyze-btn-text">üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>
            </button>

            <div id="image-prompt-result-container" style="display: none;">
                <h4 style="color: var(--primary); margin-top: 20px;">üìù –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç:</h4>
                <div class="image-prompt-result" id="image-prompt-result"></div>
                <button class="image-prompt-copy-btn" onclick="copyImagePrompt()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç</button>
            </div>
        </div>
    </div>
    <!-- === –ö–û–ù–ï–¶ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ === -->

    <div id="help-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeHelpModal()">&times;</span>
            <h3>‚ùì –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ Groq Cloud API</h3>
            <ol>
                <li><strong>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:</strong> –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç <a href="https://console.groq.com" target="_blank">https://console.groq.com</a> –∏ –Ω–∞–∂–º–∏—Ç–µ "Sign Up" (–∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Google/GitHub). –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –±–µ–∑ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∫–∞—Ä—Ç—ã. –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ free tier —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.</li>
                <li><strong>–ü–æ–ª—É—á–µ–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ API-–∫–ª—é—á–∞:</strong> –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "API Keys" (<a href="https://console.groq.com/keys" target="_blank">https://console.groq.com/keys</a>). –ù–∞–∂–º–∏—Ç–µ "Create API Key", —É–∫–∞–∂–∏—Ç–µ –∏–º—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á. –û–Ω –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. <strong>–ö–õ–Æ–ß –°–ö–û–ü–ò–†–£–ô–¢–ï –ò –°–û–•–†–ê–ù–ò–¢–ï. –ü–†–û–°–ú–û–¢–†–ï–¢–¨ –ï–ì–û –ü–û–¢–û–ú –ë–£–î–ï–¢ –ù–ï–õ–¨–ó–Ø.</strong></li>
                <li><strong>–í—ã–±–æ—Ä –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏:</strong> –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ playground (<a href="https://console.groq.com/playground" target="_blank">https://console.groq.com/playground</a>) –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –º–æ–¥–µ–ª–µ–π (<a href="https://console.groq.com/docs/models" target="_blank">https://console.groq.com/docs/models</a>), –≥–¥–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Llama 3.1, Mixtral, Gemma, Whisper). –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –µ—ë –≤ API-–∑–∞–ø—Ä–æ—Å—ã —Å –≤–∞—à–∏–º –∫–ª—é—á–æ–º (<a href="https://console.groq.com/docs/quickstart" target="_blank">–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>). –£—á—Ç–∏—Ç–µ –ª–∏–º–∏—Ç—ã free tier: –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è Llama-3.1-405b ‚Äî 131 072 —Ç–æ–∫–µ–Ω–æ–≤ –≤ –º–∏–Ω—É—Ç—É/–¥–µ–Ω—å; –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π –ª–∏–º–∏—Ç—ã –Ω–∏–∂–µ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç–µ). Developer tier –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–æ 10x –≤—ã—à–µ –ª–∏–º–∏—Ç—ã –∑–∞ –ø–ª–∞—Ç—É.</li>
            </ol>
        </div>
    </div>

    <!-- === –ù–û–í–ê–Ø –ú–û–î–ê–õ–ö–ê: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Hugging Face === -->
    <div id="hf-help-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeHFHelpModal()">&times;</span>
            <h3>‚ùì –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω Hugging Face</h3>
            <ol>
                <li><strong>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:</strong> –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ <a href="https://huggingface.co/join" target="_blank">https://huggingface.co/join</a> –∏ —Å–æ–∑–¥–∞–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.</li>
                <li><strong>–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:</strong> –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤: <a href="https://huggingface.co/settings/tokens" target="_blank">https://huggingface.co/settings/tokens</a></li>
                <li><strong>–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:</strong> –ù–∞–∂–º–∏—Ç–µ "New token", –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø "Read" (–¥–ª—è —á—Ç–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ), –¥–∞–π—Ç–µ –∏–º—è —Ç–æ–∫–µ–Ω—É –∏ –Ω–∞–∂–º–∏—Ç–µ "Generate".</li>
                <li><strong>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:</strong> –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –ø–æ–ª–µ –≤—ã—à–µ. <strong>–¢–æ–∫–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!</strong> –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –≤ –Ω–∞–¥—ë–∂–Ω–æ–º –º–µ—Å—Ç–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ–∫–±–æ–∫—Å "–ó–∞–ø–æ–º–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω".</li>
                <li><strong>–ú–æ–¥–µ–ª—å:</strong> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –º–æ–¥–µ–ª—å <code>llava-hf/llava-1.5-7b-hf</code> –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤.</li>
            </ol>
        </div>
    </div>
    <!-- === –ö–û–ù–ï–¶ –Ω–æ–≤–æ–π –º–æ–¥–∞–ª–∫–∏ === -->
    
    <div id="translation-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeTranslationModal()">&times;</span>
            <h3>üá∑üá∫ –ü–µ—Ä–µ–≤–æ–¥ –ø—Ä–æ–º–ø—Ç–∞</h3>
            <p>–í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —ç—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ:</p>
            <div id="translation-result" class="translation-result">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞...</div>
            <button class="translation-copy-btn" onclick="copyTranslation()" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥">üìã</button>
        </div>
    </div>

    <div class="notification" id="notification">–ü—Ä–æ–º–ø—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!</div>

    <div id="preset-modal" class="modal">
        <div class="preset-modal-content">
            <h3>üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ—Å–µ—Ç</h3>
            <input type="text" id="preset-name-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–∞...">
            <div class="preset-modal-actions">
                <button class="btn-save" onclick="confirmSavePreset()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn-cancel" onclick="closePresetModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="import-modal" class="modal">
        <div class="preset-modal-content">
            <h3>üì• –ò–º–ø–æ—Ä—Ç –ø—Ä–µ—Å–µ—Ç–æ–≤</h3>
            <textarea id="import-json-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JSON..." style="height: 150px; font-family: monospace; font-size: 12px;"></textarea>
            <div class="preset-modal-actions">
                <button class="btn-save" onclick="confirmImportPresets()">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn-cancel" onclick="closeImportModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast">–°–æ–æ–±—â–µ–Ω–∏–µ</div>

    <div class="history-container" style="margin-top: 20px;">
        <div class="section-header" onclick="toggleSection('presets')">
            <h3>üíæ –ü—Ä–µ—Å–µ—Ç—ã</h3>
            <span class="toggle-icon collapsed" id="presets-toggle">‚ñº</span>
        </div>
        <div class="section-content" id="presets-content">
            <div class="preset-controls">
                <button class="preset-btn" onclick="savePresetDialog()" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ—Å–µ—Ç">üíæ</button>
                <button class="preset-btn secondary" onclick="exportPresets()" title="–≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–µ—Å–µ—Ç–æ–≤">üì§</button>
                <button class="preset-btn secondary" onclick="importPresetsDialog()" title="–ò–º–ø–æ—Ä—Ç –ø—Ä–µ—Å–µ—Ç–æ–≤">üì•</button>
            </div>
            <div class="preset-list" id="preset-list"></div>
        </div>
    </div>

    <script>
        const MODEL_KEY = 'flux_groq_model';
        const API_KEY_STORAGE = 'flux_groq_api_key';
        const REMEMBER_KEY_FLAG = 'flux_remember_api_key';
        const HF_TOKEN_STORAGE = 'flux_hf_api_token';
        const REMEMBER_HF_TOKEN_FLAG = 'flux_remember_hf_token';
        let GROQ_KEY = '';
        let HF_TOKEN = '';
        let SELECTED_MODEL = localStorage.getItem(MODEL_KEY) || 'llama3-8b-8192';
        let currentImageFile = null;

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('model-input').value = SELECTED_MODEL;

            const rememberKey = localStorage.getItem(REMEMBER_KEY_FLAG) === 'true';
            document.getElementById('remember-key').checked = rememberKey;
            if (rememberKey) {
                const savedKey = localStorage.getItem(API_KEY_STORAGE);
                if (savedKey) {
                    document.getElementById('api-key').value = savedKey;
                    GROQ_KEY = savedKey;
                }
            }

            const rememberHFToken = localStorage.getItem(REMEMBER_HF_TOKEN_FLAG) === 'true';
            document.getElementById('remember-hf-token').checked = rememberHFToken;
            if (rememberHFToken) {
                const savedToken = localStorage.getItem(HF_TOKEN_STORAGE);
                if (savedToken) {
                    document.getElementById('hf-token').value = savedToken;
                    HF_TOKEN = savedToken;
                }
            }

            document.getElementById('remember-key').addEventListener('change', (e) => {
                localStorage.setItem(REMEMBER_KEY_FLAG, e.target.checked);
                if (e.target.checked) {
                    const key = document.getElementById('api-key').value;
                    if (key) localStorage.setItem(API_KEY_STORAGE, key);
                } else {
                    localStorage.removeItem(API_KEY_STORAGE);
                }
            });

            document.getElementById('remember-hf-token').addEventListener('change', (e) => {
                localStorage.setItem(REMEMBER_HF_TOKEN_FLAG, e.target.checked);
                if (e.target.checked) {
                    const token = document.getElementById('hf-token').value;
                    if (token) localStorage.setItem(HF_TOKEN_STORAGE, token);
                } else {
                    localStorage.removeItem(HF_TOKEN_STORAGE);
                }
            });

            document.getElementById('api-key').addEventListener('input', (e) => {
                GROQ_KEY = e.target.value;
                if (document.getElementById('remember-key').checked) {
                    localStorage.setItem(API_KEY_STORAGE, GROQ_KEY);
                }
            });

            document.getElementById('hf-token').addEventListener('input', (e) => {
                HF_TOKEN = e.target.value;
                if (document.getElementById('remember-hf-token').checked) {
                    localStorage.setItem(HF_TOKEN_STORAGE, HF_TOKEN);
                }
                updateAnalyzeButtonState();
            });

            document.getElementById('model-input').addEventListener('input', (e) => {
                SELECTED_MODEL = e.target.value;
                localStorage.setItem(MODEL_KEY, SELECTED_MODEL);
            });

            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è';
            }

            renderStyles();
            renderArtistic();
            renderHistory();
            renderPresets();
            renderRandomExamples();
            initializeImageRecognition();
        });

        const inputEl = document.getElementById('input');
        const outputEl = document.getElementById('output');
        const enhancedOutputEl = document.getElementById('enhanced-output');

        const styleDescriptions = {
            'realistic': 'ultra realistic, photorealistic, 8k resolution, professional photography',
            'anime': 'anime style, vibrant colors, detailed anime artwork',
            'digital_art': 'digital art, trending on artstation, highly detailed',
            'oil_painting': 'oil painting, classic art style, traditional painting',
            'watercolor': 'watercolor painting, soft colors, artistic watercolor',
            'pencil': 'pencil sketch, detailed drawing, graphite art',
            'cartoon': 'cartoon style, bright colors, fun and playful',
            'cyberpunk': 'cyberpunk style, neon lights, futuristic cityscape',
            'fantasy': 'fantasy art, magical atmosphere, epic fantasy scene',
            'sci-fi': 'science fiction, futuristic, advanced technology',
            'horror': 'horror atmosphere, dark and eerie, suspenseful mood',
            'steampunk': 'steampunk aesthetic, Victorian-era machinery, brass and copper tones',
            'minimalist': 'minimalist design, clean lines, simple composition',
            'abstract': 'abstract art, non-representational, experimental forms',
            'surreal': 'surrealism, dreamlike imagery, unexpected combinations',
            'comic': 'comic book style, bold outlines, dynamic action',
            'retro': 'retro aesthetic, vintage style, nostalgic atmosphere',
            'noir': 'film noir style, high contrast, dramatic shadows',
            '3d_render': '3D render, CGI, photorealistic rendering',
            'isometric': 'isometric view, geometric precision, technical illustration',
            'pixel': 'pixel art, 8-bit style, retro gaming aesthetic',
            'pop_art': 'pop art style, bold colors, Andy Warhol inspired',
            'impressionist': 'impressionist painting, loose brushstrokes, Monet style',
            'baroque': 'baroque art style, ornate details, dramatic lighting',
            'art_nouveau': 'art nouveau style, flowing lines, decorative elements',
            'art_deco': 'art deco design, geometric patterns, 1920s aesthetic',
            'gothic': 'gothic style, dark atmosphere, medieval architecture',
            'renaissance': 'Renaissance painting, classical composition, masterwork',
            'cubist': 'cubist style, geometric shapes, Picasso inspired',
            'vaporwave': 'vaporwave aesthetic, pastel colors, 80s nostalgia',
            'low_poly': 'low poly art, geometric shapes, minimalist 3D',
            'glitch': 'glitch art, digital corruption, distorted imagery'
        };

        const styleTranslations = {
            'realistic': '–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π',
            'anime': '–ê–Ω–∏–º–µ',
            'digital_art': '–¶–∏—Ñ—Ä–æ–≤–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ',
            'oil_painting': '–ú–∞—Å–ª–æ',
            'watercolor': '–ê–∫–≤–∞—Ä–µ–ª—å',
            'pencil': '–ö–∞—Ä–∞–Ω–¥–∞—à',
            'cartoon': '–ú—É–ª—å—Ç—è—à–Ω—ã–π',
            'cyberpunk': '–ö–∏–±–µ—Ä–ø–∞–Ω–∫',
            'fantasy': '–§—ç–Ω—Ç–µ–∑–∏',
            'sci-fi': '–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞',
            'horror': '–•–æ—Ä—Ä–æ—Ä',
            'steampunk': '–°—Ç–∏–º–ø–∞–Ω–∫',
            'minimalist': '–ú–∏–Ω–∏–º–∞–ª–∏–∑–º',
            'abstract': '–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è',
            'surreal': '–°—é—Ä—Ä–µ–∞–ª–∏–∑–º',
            'comic': '–ö–æ–º–∏–∫—Å',
            'retro': '–†–µ—Ç—Ä–æ',
            'noir': '–ù—É–∞—Ä',
            '3d_render': '3D-—Ä–µ–Ω–¥–µ—Ä',
            'isometric': '–ò–∑–æ–º–µ—Ç—Ä–∏—è',
            'pixel': '–ü–∏–∫—Å–µ–ª—å-–∞—Ä—Ç',
            'pop_art': '–ü–æ–ø-–∞—Ä—Ç',
            'impressionist': '–ò–º–ø—Ä–µ—Å—Å–∏–æ–Ω–∏–∑–º',
            'baroque': '–ë–∞—Ä–æ–∫–∫–æ',
            'art_nouveau': '–ú–æ–¥–µ—Ä–Ω',
            'art_deco': '–ê—Ä-–¥–µ–∫–æ',
            'gothic': '–ì–æ—Ç–∏–∫–∞',
            'renaissance': '–†–µ–Ω–µ—Å—Å–∞–Ω—Å',
            'cubist': '–ö—É–±–∏–∑–º',
            'vaporwave': '–í–µ–π–ø–æ—Ä–≤–µ–π–≤',
            'low_poly': '–õ–æ—É-–ø–æ–ª–∏',
            'glitch': '–ì–ª–∏—Ç—á'
        };

        const styleCategories = {
            '–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏': ['realistic', 'anime', 'digital_art', 'cartoon'],
            '–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ': ['oil_painting', 'watercolor', 'pencil', 'impressionist', 'renaissance', 'baroque'],
            '–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ': ['abstract', 'surreal', 'cubist', 'pop_art', 'minimalist'],
            '–ñ–∞–Ω—Ä—ã': ['fantasy', 'sci-fi', 'horror', 'cyberpunk', 'steampunk', 'gothic'],
            '–¶–∏—Ñ—Ä–æ–≤–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ': ['3d_render', 'isometric', 'pixel', 'low_poly', 'glitch'],
            '–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è': ['comic', 'retro', 'noir', 'art_nouveau', 'art_deco', 'vaporwave']
        };

        const artisticTemplates = {
            'golden_ratio': 'golden ratio composition, fibonacci spiral, harmonious proportions',
            'symmetry': 'perfect symmetry, balanced composition, mirror effect',
            'rule_of_thirds': 'rule of thirds composition, dynamic placement',
            'leading_lines': 'leading lines, perspective depth, visual flow',
            'framing': 'natural framing, focus on subject, layered composition',
            'depth_of_field': 'shallow depth of field, bokeh background, professional focus',
            'color_harmony': 'color harmony, complementary colors, balanced palette',
            'chiaroscuro': 'chiaroscuro lighting, strong light-dark contrast',
            'atmospheric': 'atmospheric perspective, depth through haze, layered distances',
            'dynamic_pose': 'dynamic pose, action shot, movement captured',
            'macro': 'macro photography, extreme close-up, intricate details',
            'wide_angle': 'wide angle view, expansive scene, panoramic perspective',
            'birds_eye': 'bird\'s eye view, overhead perspective, top-down angle',
            'worms_eye': 'worm\'s eye view, looking up, dramatic low angle',
            'dutch_angle': 'Dutch angle, tilted horizon, dynamic tension',
            'silhouette': 'silhouette, backlit subject, strong outline',
            'reflection': 'reflection effect, mirrored surface, double image',
            'texture': 'rich texture, tactile quality, surface detail',
            'pattern': 'repeating pattern, geometric design, visual rhythm',
            'negative_space': 'negative space, minimalist composition, breathing room',
            'motion_blur': 'motion blur, speed effect, dynamic movement',
            'long_exposure': 'long exposure, light trails, smooth water effect',
            'hdr': 'HDR effect, high dynamic range, enhanced details',
            'vintage_grain': 'vintage film grain, analog photography aesthetic',
            'lens_flare': 'lens flare, sun rays, optical effect',
            'vignette': 'vignette effect, darkened edges, focus on center',
            'tilt_shift': 'tilt-shift effect, miniature appearance, selective focus',
            'double_exposure': 'double exposure, overlapping images, artistic blend',
            'rim_lighting': 'rim lighting, edge highlight, dramatic outline',
            'god_rays': 'god rays, volumetric lighting, light beams',
            'foggy': 'foggy atmosphere, mysterious mood, diffused light',
            'rainy': 'rainy weather, wet surfaces, water droplets',
            'snowy': 'snowy scene, winter atmosphere, white landscape',
            'sunset': 'sunset lighting, warm orange glow, golden hour',
            'sunrise': 'sunrise scene, morning light, soft awakening',
            'twilight': 'twilight hour, blue hour, magical transition',
            'starry_night': 'starry night sky, celestial view, night photography',
            'aurora': 'aurora borealis, northern lights, colorful sky',
            'moonlight': 'moonlit scene, silvery glow, night atmosphere',
            'candlelight': 'candlelight illumination, warm intimate glow',
            'neon': 'neon lights, vibrant glow, urban night',
            'bioluminescent': 'bioluminescent, glowing organisms, ethereal light',
            'underwater': 'underwater scene, aquatic environment, submerged view',
            'aerial': 'aerial view, drone perspective, bird\'s flight',
            'microscopic': 'microscopic view, cellular detail, scientific beauty',
            'cosmic': 'cosmic scene, space environment, nebula and stars',
            'dystopian': 'dystopian atmosphere, post-apocalyptic, desolate mood',
            'utopian': 'utopian vision, ideal world, harmonious scene',
            'whimsical': 'whimsical style, playful elements, imaginative design',
            'elegant': 'elegant composition, refined aesthetic, sophisticated style',
            'gritty': 'gritty texture, rough aesthetic, raw atmosphere',
            'ethereal': 'ethereal quality, otherworldly beauty, transcendent mood',
            'dramatic': 'dramatic composition, high tension, emotional impact',
            'serene': 'serene atmosphere, peaceful mood, tranquil scene',
            'energetic': 'energetic composition, vibrant activity, lively scene',
            'melancholic': 'melancholic mood, wistful atmosphere, nostalgic feeling',
            'mysterious': 'mysterious atmosphere, enigmatic scene, hidden secrets',
            'romantic': 'romantic mood, passionate atmosphere, emotional connection',
            'epic': 'epic scale, grand composition, larger than life',
            'intimate': 'intimate framing, close personal moment, emotional closeness'
        };

        const artisticTranslations = {
            'golden_ratio': '–ó–æ–ª–æ—Ç–æ–µ —Å–µ—á–µ–Ω–∏–µ',
            'symmetry': '–°–∏–º–º–µ—Ç—Ä–∏—è',
            'rule_of_thirds': '–ü—Ä–∞–≤–∏–ª–æ —Ç—Ä–µ—Ç–µ–π',
            'leading_lines': '–ù–∞–ø—Ä–∞–≤–ª—è—é—â–∏–µ –ª–∏–Ω–∏–∏',
            'framing': '–ö–∞–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ',
            'depth_of_field': '–ì–ª—É–±–∏–Ω–∞ —Ä–µ–∑–∫–æ—Å—Ç–∏',
            'color_harmony': '–¶–≤–µ—Ç–æ–≤–∞—è –≥–∞—Ä–º–æ–Ω–∏—è',
            'chiaroscuro': '–ö—å—è—Ä–æ—Å–∫—É—Ä–æ',
            'atmospheric': '–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞',
            'dynamic_pose': '–î–∏–Ω–∞–º–∏—á–Ω–∞—è –ø–æ–∑–∞',
            'macro': '–ú–∞–∫—Ä–æ—Å—ä—ë–º–∫–∞',
            'wide_angle': '–®–∏—Ä–æ–∫–∏–π —É–≥–æ–ª',
            'birds_eye': '–í–∏–¥ —Å –≤—ã—Å–æ—Ç—ã –ø—Ç–∏—á—å–µ–≥–æ –ø–æ–ª—ë—Ç–∞',
            'worms_eye': '–í–∏–¥ —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö',
            'dutch_angle': '–ì–æ–ª–ª–∞–Ω–¥—Å–∫–∏–π —É–≥–æ–ª',
            'silhouette': '–°–∏–ª—É—ç—Ç',
            'reflection': '–û—Ç—Ä–∞–∂–µ–Ω–∏–µ',
            'texture': '–¢–µ–∫—Å—Ç—É—Ä–∞',
            'pattern': '–ü–∞—Ç—Ç–µ—Ä–Ω',
            'negative_space': '–ù–µ–≥–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ',
            'motion_blur': '–†–∞–∑–º—ã—Ç–∏–µ –≤ –¥–≤–∏–∂–µ–Ω–∏–∏',
            'long_exposure': '–î–ª–∏–Ω–Ω–∞—è –≤—ã–¥–µ—Ä–∂–∫–∞',
            'hdr': 'HDR —ç—Ñ—Ñ–µ–∫—Ç',
            'vintage_grain': '–í–∏–Ω—Ç–∞–∂–Ω–∞—è –∑–µ—Ä–Ω–∏—Å—Ç–æ—Å—Ç—å',
            'lens_flare': '–ë–ª–∏–∫–∏',
            'vignette': '–í–∏–Ω—å–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
            'tilt_shift': '–¢–∏–ª—Ç-—à–∏—Ñ—Ç',
            'double_exposure': '–î–≤–æ–π–Ω–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è',
            'rim_lighting': '–ö–æ–Ω—Ç—Ä–æ–≤–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ',
            'god_rays': '–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª—É—á–∏',
            'foggy': '–¢—É–º–∞–Ω–Ω—ã–π',
            'rainy': '–î–æ–∂–¥–ª–∏–≤—ã–π',
            'snowy': '–°–Ω–µ–∂–Ω—ã–π',
            'sunset': '–ó–∞–∫–∞—Ç',
            'sunrise': '–†–∞—Å—Å–≤–µ—Ç',
            'twilight': '–°—É–º–µ—Ä–∫–∏',
            'starry_night': '–ó–≤—ë–∑–¥–Ω–∞—è –Ω–æ—á—å',
            'aurora': '–°–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ',
            'moonlight': '–õ—É–Ω–Ω—ã–π —Å–≤–µ—Ç',
            'candlelight': '–°–≤–µ—Ç —Å–≤–µ—á–µ–π',
            'neon': '–ù–µ–æ–Ω',
            'bioluminescent': '–ë–∏–æ–ª—é–º–∏–Ω–µ—Å—Ü–µ–Ω—Ü–∏—è',
            'underwater': '–ü–æ–¥–≤–æ–¥–Ω—ã–π',
            'aerial': '–í–æ–∑–¥—É—à–Ω—ã–π',
            'microscopic': '–ú–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∏–π',
            'cosmic': '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π',
            'dystopian': '–î–∏—Å—Ç–æ–ø–∏—á–µ—Å–∫–∏–π',
            'utopian': '–£—Ç–æ–ø–∏—á–µ—Å–∫–∏–π',
            'whimsical': '–ü—Ä–∏—á—É–¥–ª–∏–≤—ã–π',
            'elegant': '–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π',
            'gritty': '–ì—Ä—É–±—ã–π',
            'ethereal': '–≠—Ñ–∏—Ä–Ω—ã–π',
            'dramatic': '–î—Ä–∞–º–∞—Ç–∏—á–Ω—ã–π',
            'serene': '–°–ø–æ–∫–æ–π–Ω—ã–π',
            'energetic': '–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π',
            'melancholic': '–ú–µ–ª–∞–Ω—Ö–æ–ª–∏—á–Ω—ã–π',
            'mysterious': '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π',
            'romantic': '–†–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π',
            'epic': '–≠–ø–∏—á–Ω—ã–π',
            'intimate': '–ò–Ω—Ç–∏–º–Ω—ã–π'
        };

        const artisticCategories = {
            '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è': {
                '–û—Å–Ω–æ–≤—ã': ['golden_ratio', 'symmetry', 'rule_of_thirds', 'leading_lines', 'framing', 'negative_space'],
                '–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞': ['birds_eye', 'worms_eye', 'dutch_angle', 'aerial', 'wide_angle']
            },
            '–≠—Ñ—Ñ–µ–∫—Ç—ã –∫–∞–º–µ—Ä—ã': {
                '–§–æ–∫—É—Å –∏ –≥–ª—É–±–∏–Ω–∞': ['depth_of_field', 'macro', 'tilt_shift'],
                '–î–≤–∏–∂–µ–Ω–∏–µ': ['motion_blur', 'long_exposure'],
                '–û–±—Ä–∞–±–æ—Ç–∫–∞': ['hdr', 'vintage_grain', 'lens_flare', 'vignette', 'double_exposure']
            },
            '–û—Å–≤–µ—â–µ–Ω–∏–µ': {
                '–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ': ['sunset', 'sunrise', 'twilight', 'moonlight'],
                '–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ': ['candlelight', 'neon', 'rim_lighting', 'god_rays'],
                '–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ —è–≤–ª–µ–Ω–∏—è': ['starry_night', 'aurora', 'bioluminescent']
            },
            '–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞': {
                '–ü–æ–≥–æ–¥–∞': ['foggy', 'rainy', 'snowy'],
                '–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ': ['dramatic', 'serene', 'energetic', 'melancholic', 'mysterious', 'romantic', 'whimsical']
            },
            '–í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã': {
                '–ë–∞–∑–æ–≤—ã–µ': ['silhouette', 'reflection', 'texture', 'pattern', 'color_harmony'],
                '–°—Ç–∏–ª—å': ['elegant', 'gritty', 'ethereal', 'epic', 'intimate']
            },
            '–û–∫—Ä—É–∂–µ–Ω–∏–µ': {
                '–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –≤–∏–¥—ã': ['underwater', 'microscopic', 'cosmic'],
                '–ú–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ': ['dystopian', 'utopian']
            },
            '–¢–µ—Ö–Ω–∏–∫–∏': {
                '–°–≤–µ—Ç–æ–≤—ã–µ': ['chiaroscuro', 'atmospheric'],
                '–ö–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ': ['dynamic_pose']
            }
        };

        const enhancePrompts = {
            artistic: "You are an expert AI art prompt engineer. Enhance the following prompt to be more artistic and visually appealing. Add creative details about composition, color palette, mood, and artistic style. Keep it concise but impactful. Respond ONLY with the enhanced prompt, no explanations.",
            technical: "You are a technical AI art prompt engineer. Enhance the following prompt with precise technical details about lighting, camera settings, rendering quality, and visual parameters. Include specific technical terms. Respond ONLY with the enhanced prompt, no explanations.",
            cinematic: "You are a cinematic AI prompt engineer. Transform the following prompt into a cinematic masterpiece description. Add details about dramatic lighting, camera angles, depth of field, and film-like atmosphere. Respond ONLY with the enhanced prompt, no explanations.",
            anime: "You are an anime art expert. Enhance the following prompt with anime-specific details: character style, vibrant colors, dynamic poses, and typical anime aesthetic elements. Respond ONLY with the enhanced prompt, no explanations.",
            minimalist: "You are a minimalist design expert. Refine the following prompt to emphasize simplicity, clean lines, essential elements, and negative space. Remove unnecessary details while maintaining the core concept. Respond ONLY with the enhanced prompt, no explanations."
        };

        const promptExamples = [
            '–ö–æ—Ç –Ω–∞ –∫—Ä—ã—à–µ –ø–æ–¥ –ª—É–Ω–æ–π',
            '–î—Ä–∞–∫–æ–Ω –Ω–∞–¥ –≥–æ—Ä–Ω—ã–º —Ö—Ä–µ–±—Ç–æ–º',
            '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å –≤ —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–∏',
            '–§—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –≥–æ—Ä–æ–¥ –≤ –¥–æ–∂–¥—å',
            '–í–æ–ª—à–µ–±–Ω—ã–π –ª–µ—Å —Å —Å–≤–µ—Ç—è—â–∏–º–∏—Å—è –≥—Ä–∏–±–∞–º–∏',
            '–°—Ç–∞—Ä–∏–Ω–Ω—ã–π –∑–∞–º–æ–∫ –Ω–∞ —É—Ç—ë—Å–µ',
            '–ü–æ–¥–≤–æ–¥–Ω—ã–π –≥–æ—Ä–æ–¥ —Å —Ä—É—Å–∞–ª–∫–∞–º–∏',
            '–†–æ–±–æ—Ç –≤ –∑–∞–±—Ä–æ—à–µ–Ω–Ω–æ–º –∑–¥–∞–Ω–∏–∏',
            '–§–µ–Ω–∏–∫—Å, –≤–æ—Å—Å—Ç–∞—é—â–∏–π –∏–∑ –ø–µ–ø–ª–∞',
            '–í–∏–∫–∏–Ω–≥ –≤ –±–∏—Ç–≤–µ —Å –º–æ—Ä—Å–∫–∏–º —á—É–¥–æ–≤–∏—â–µ–º',
            '–≠–ª—å—Ñ–∏–π—Å–∫–∞—è –ø—Ä–∏–Ω—Ü–µ—Å—Å–∞ –≤ –ª–µ—Å—É',
            '–°–∞–º—É—Ä–∞–π –Ω–∞ —Ñ–æ–Ω–µ —Å–∞–∫—É—Ä—ã',
            '–ö–∏–±–æ—Ä–≥ –≤ –Ω–µ–æ–Ω–æ–≤–æ–º –ø–µ—Ä–µ—É–ª–∫–µ',
            '–ü–∏—Ä–∞—Ç—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å –≤ —à—Ç–æ—Ä–º',
            '–ê–Ω–≥–µ–ª –∏ –¥–µ–º–æ–Ω –ª–∏—Ü–æ–º –∫ –ª–∏—Ü—É',
            '–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π –¥—Ä–∞–∫–æ–Ω –≤ –ø—É—Å—Ç—ã–Ω–µ',
            '–ú–µ–¥–∏—Ç–∏—Ä—É—é—â–∏–π –º–æ–Ω–∞—Ö –≤ —Ö—Ä–∞–º–µ',
            '–ö–æ—Å–º–æ–Ω–∞–≤—Ç –Ω–∞ —á—É–∂–æ–π –ø–ª–∞–Ω–µ—Ç–µ',
            '–í–µ–¥—å–º–∞ –≤–∞—Ä–∏—Ç –∑–µ–ª—å–µ',
            '–†—ã—Ü–∞—Ä—å –ø–µ—Ä–µ–¥ –¥—Ä–∞–∫–æ–Ω–æ–º'
        ];

        function renderRandomExamples() {
            const examplesList = document.getElementById('examples-list');
            const shuffled = [...promptExamples].sort(() => 0.5 - Math.random());
            const selected = shuffled.slice(0, 6);
            examplesList.innerHTML = selected.map(ex =>
                `<span class="example-btn" onclick="useExample('${ex.replace(/'/g, "\\'")}')">${ex}</span>`
            ).join('');
        }

        function useExample(text) {
            inputEl.value = text;
            generatePrompt();
        }

        function renderStyles() {
            const container = document.getElementById('styles-content');
            let html = '';
            for (let category in styleCategories) {
                html += `<div class="section-header" style="margin-top: 10px;"><h3 style="font-size: 14px; color: var(--text);">${category}</h3></div>`;
                html += `<div class="styles-list">`;
                styleCategories[category].forEach(key => {
                    html += `<label class="style-option">
                        <input type="radio" name="style" value="${key}" onchange="generatePrompt()">
                        ${styleTranslations[key]}
                    </label>`;
                });
                html += `</div>`;
            }
            container.innerHTML = html;
        }

        function renderArtistic() {
            const container = document.getElementById('artistic-content');
            let html = '';

            function renderCategory(categories, level = 1) {
                let result = '';
                for (let category in categories) {
                    const content = categories[category];
                    const isSubcategory = typeof content === 'object' && !Array.isArray(content);
                    const categoryId = category.replace(/\s+/g, '-').toLowerCase();

                    if (isSubcategory) {
                        result += `<div class="artistic-category-level-${level}">`;
                        result += `<div class="section-header" onclick="toggleSubcategory('${categoryId}')">`;
                        result += level === 1 
                            ? `<h3 style="font-size: 14px; margin: 0;">${category}</h3>` 
                            : `<h4 style="font-size: 13px; margin: 0;">${category}</h4>`;
                        result += `<span class="toggle-icon collapsed" id="${categoryId}-toggle">‚ñº</span>`;
                        result += `</div>`;
                        result += `<div class="subcategory-content" id="${categoryId}-content">`;
                        result += renderCategory(content, level + 1);
                        result += `</div></div>`;
                    } else {
                        result += `<div class="artistic-category-level-${level}">`;
                        result += level === 1 
                            ? `<h3 style="font-size: 14px; margin-top: 10px;">${category}</h3>` 
                            : `<h4 style="font-size: 13px; margin-top: 8px;">${category}</h4>`;
                        result += `<div class="styles-list">`;
                        content.forEach(key => {
                            result += `<label class="style-option">
                                <input type="checkbox" class="artistic-checkbox" value="${key}" onchange="handleArtisticChange()">
                                ${artisticTranslations[key]}
                            </label>`;
                        });
                        result += `</div></div>`;
                    }
                }
                return result;
            }

            html = renderCategory(artisticCategories);
            container.innerHTML = html;
            updateArtisticCounter();
        }

        function handleArtisticChange() {
            limitArtisticCheckboxes();
            updateArtisticCounter();
            generatePrompt();
        }

        function limitArtisticCheckboxes() {
            const checkboxes = document.querySelectorAll('.artistic-checkbox');
            const checked = document.querySelectorAll('.artistic-checkbox:checked');
            if (checked.length > 5) {
                showToast('‚ö†Ô∏è –ú–∞–∫—Å–∏–º—É–º 5 —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤!');
                checked[checked.length - 1].checked = false;
            }
        }

        function updateArtisticCounter() {
            const checked = document.querySelectorAll('.artistic-checkbox:checked');
            const counter = document.getElementById('artistic-counter');
            counter.textContent = `${checked.length}/5`;
            if (checked.length > 5) {
                counter.classList.add('exceeded');
            } else {
                counter.classList.remove('exceeded');
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function toggleSubcategory(id) {
            const content = document.getElementById(`${id}-content`);
            const toggle = document.getElementById(`${id}-toggle`);
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                toggle.classList.add('collapsed');
            } else {
                content.classList.add('expanded');
                toggle.classList.remove('collapsed');
            }
        }

        async function generatePrompt() {
            const input = inputEl.value.trim();
            if (!input) {
                outputEl.value = '';
                return;
            }

            const selectedStyle = document.querySelector('input[name="style"]:checked');
            const selectedArtistic = Array.from(document.querySelectorAll('.artistic-checkbox:checked')).map(cb => cb.value);
            const resolution = document.getElementById('resolution').value;
            const lighting = document.getElementById('lighting').value;
            const colors = document.getElementById('colors').value;
            const focus = document.getElementById('focus').value;
            const detail = document.getElementById('detail').value;

            try {
                const translated = await translateText(input, 'en');
                let basePart = translated;
                if (selectedStyle) {
                    const template = styleDescriptions[selectedStyle.value];
                    basePart = `${translated}, ${template}`;
                }

                let artisticPart = '';
                if (selectedArtistic.length > 0) {
                    const artisticDescriptions = selectedArtistic.map(key => artisticTemplates[key]);
                    artisticPart = artisticDescriptions.join(', ');
                }

                const qualityParts = [resolution, lighting, colors, focus, detail].filter(v => v);
                const qualityPart = qualityParts.join(', ');

                let finalPrompt = [basePart, artisticPart, qualityPart].filter(p => p).join(', ');

                if (input.endsWith('.')) {
                    if (!finalPrompt.endsWith('.')) finalPrompt += '.';
                } else {
                    if (finalPrompt.endsWith('.')) finalPrompt = finalPrompt.slice(0, -1);
                }

                outputEl.value = finalPrompt;
            } catch (error) {
                console.error('Translation error:', error);
                outputEl.value = input;
            }
        }

        async function translateText(text, targetLang) {
            try {
                const response = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`);
                const data = await response.json();
                return data[0].map(item => item[0]).join('');
            } catch (error) {
                throw error;
            }
        }

        async function enhanceArtistically() {
            const prompt = outputEl.value.trim();
            if (!prompt) {
                showNotification('‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç!', 'warning');
                return;
            }

            const apiKey = document.getElementById('api-key').value.trim();
            if (!apiKey) {
                showNotification('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ API-–∫–ª—é—á Groq!', 'warning');
                return;
            }

            const model = SELECTED_MODEL || 'llama3-8b-8192';
            const mode = document.getElementById('enhance-mode').value;
            const systemPrompt = enhancePrompts[mode];

            const enhanceBtn = document.getElementById('enhance-btn');
            enhanceBtn.disabled = true;
            enhanceBtn.innerHTML = '<span class="loading-spinner"></span>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...';

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: model,
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.9,
                        max_tokens: 500
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                const enhanced = data.choices[0].message.content.trim();
                enhancedOutputEl.value = enhanced;
                showNotification('‚úÖ –ü—Ä–æ–º–ø—Ç —É–ª—É—á—à–µ–Ω!', 'success');
            } catch (error) {
                console.error('Enhance error:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞!', 'error');
            } finally {
                enhanceBtn.disabled = false;
                enhanceBtn.innerHTML = 'üé®';
            }
        }

        function copyPrompt(source) {
            const text = document.getElementById(source).value;
            if (!text) return;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('üìã –ü—Ä–æ–º–ø—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'success');
                saveToHistory(text);
            });
        }

        function showNotification(message, type = 'success') {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            if (type === 'warning') notif.style.background = 'var(--danger)';
            else if (type === 'success') notif.style.background = 'var(--success)';
            notif.classList.add('show');
            setTimeout(() => notif.classList.remove('show'), 3000);
        }

        function saveToHistory(prompt) {
            let history = JSON.parse(localStorage.getItem('prompt_history') || '[]');
            history.unshift({ text: prompt, time: Date.now() });
            history = history.slice(0, 60);
            localStorage.setItem('prompt_history', JSON.stringify(history));
            renderHistory();
        }

        function renderHistory() {
            const history = JSON.parse(localStorage.getItem('prompt_history') || '[]');
            const grid = document.getElementById('history-grid');
            if (history.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: var(--text-muted);">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>';
                return;
            }
            grid.innerHTML = history.map((item, idx) => {
                const short = item.text.length > 80 ? item.text.substring(0, 80) + '...' : item.text;
                return `<div class="history-item" onclick="loadFromHistory(${idx})" title="${item.text.replace(/"/g, '&quot;')}">${short}</div>`;
            }).join('');
        }

        function loadFromHistory(index) {
            const history = JSON.parse(localStorage.getItem('prompt_history') || '[]');
            if (history[index]) {
                outputEl.value = history[index].text;
                showNotification('‚úÖ –ü—Ä–æ–º–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏', 'success');
            }
        }

        function clearHistory() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–º–ø—Ç–æ–≤?')) {
                localStorage.removeItem('prompt_history');
                renderHistory();
                showNotification('üóëÔ∏è –ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞', 'success');
            }
        }

        function toggleSection(section) {
            const content = document.getElementById(`${section}-content`);
            const toggle = document.getElementById(`${section}-toggle`);
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                toggle.classList.add('collapsed');
            } else {
                content.classList.add('expanded');
                toggle.classList.remove('collapsed');
            }
        }

        document.getElementById('theme-toggle').addEventListener('click', () => {
            const current = document.documentElement.getAttribute('data-theme');
            const newTheme = current === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            document.getElementById('theme-toggle').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            localStorage.setItem('theme', newTheme);
        });

        document.getElementById('reset-button').addEventListener('click', () => {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?')) {
                document.querySelectorAll('input[type="radio"]:checked').forEach(r => r.checked = false);
                document.querySelectorAll('.artistic-checkbox:checked').forEach(cb => cb.checked = false);
                document.getElementById('resolution').value = '';
                document.getElementById('lighting').value = '';
                document.getElementById('colors').value = '';
                document.getElementById('focus').value = '';
                document.getElementById('detail').value = '';
                document.getElementById('style-search').value = '';
                document.getElementById('artistic-search').value = '';
                updateArtisticCounter();
                generatePrompt();
                showNotification('üîÑ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–±—Ä–æ—à–µ–Ω—ã', 'success');
            }
        });

        inputEl.addEventListener('input', generatePrompt);
        document.getElementById('copy-btn').addEventListener('click', () => copyPrompt('output'));
        document.getElementById('copy-enhanced-btn').addEventListener('click', () => copyPrompt('enhanced-output'));
        document.getElementById('enhance-btn').addEventListener('click', enhanceArtistically);

        document.getElementById('style-search').addEventListener('input', debounce((e) => {
            const query = e.target.value.toLowerCase();
            document.querySelectorAll('.styles-list .style-option').forEach(opt => {
                const text = opt.textContent.toLowerCase();
                opt.style.display = text.includes(query) ? '' : 'none';
            });
        }, 300));

        document.getElementById('artistic-search').addEventListener('input', debounce((e) => {
            const query = e.target.value.toLowerCase();
            document.querySelectorAll('.artistic-content .style-option').forEach(opt => {
                const text = opt.textContent.toLowerCase();
                opt.style.display = text.includes(query) ? '' : 'none';
            });
        }, 300));

        function debounce(func, wait) {
            let timeout;
            return function(...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        function openHelpModal() {
            document.getElementById('help-modal').style.display = 'block';
        }

        function closeHelpModal() {
            document.getElementById('help-modal').style.display = 'none';
        }

        function openHFHelpModal() {
            document.getElementById('hf-help-modal').style.display = 'block';
        }

        function closeHFHelpModal() {
            document.getElementById('hf-help-modal').style.display = 'none';
        }

        function translateBack(sourceId) {
            const text = document.getElementById(sourceId).value.trim();
            if (!text) {
                showNotification('‚ö†Ô∏è –ù–µ—Ç —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞!', 'warning');
                return;
            }

            document.getElementById('translation-modal').style.display = 'block';
            document.getElementById('translation-result').textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞...';

            translateText(text, 'ru').then(translated => {
                document.getElementById('translation-result').textContent = translated;
            }).catch(error => {
                document.getElementById('translation-result').textContent = '–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.';
            });
        }

        function closeTranslationModal() {
            document.getElementById('translation-modal').style.display = 'none';
        }

        function copyTranslation() {
            const text = document.getElementById('translation-result').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('üìã –ü–µ—Ä–µ–≤–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'success');
            });
        }

        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        };

        function getCurrentState() {
            const selectedStyle = document.querySelector('input[name="style"]:checked');
            const selectedArtistic = Array.from(document.querySelectorAll('.artistic-checkbox:checked')).map(cb => cb.value);
            return {
                style: selectedStyle ? selectedStyle.value : null,
                artistic: selectedArtistic,
                resolution: document.getElementById('resolution').value,
                lighting: document.getElementById('lighting').value,
                colors: document.getElementById('colors').value,
                focus: document.getElementById('focus').value,
                detail: document.getElementById('detail').value
            };
        }

        function applyState(state) {
            document.querySelectorAll('input[type="radio"]:checked').forEach(r => r.checked = false);
            document.querySelectorAll('.artistic-checkbox:checked').forEach(cb => cb.checked = false);

            if (state.style) {
                const radio = document.querySelector(`input[name="style"][value="${state.style}"]`);
                if (radio) radio.checked = true;
            }

            state.artistic.forEach(key => {
                const checkbox = document.querySelector(`.artistic-checkbox[value="${key}"]`);
                if (checkbox) checkbox.checked = true;
            });

            document.getElementById('resolution').value = state.resolution || '';
            document.getElementById('lighting').value = state.lighting || '';
            document.getElementById('colors').value = state.colors || '';
            document.getElementById('focus').value = state.focus || '';
            document.getElementById('detail').value = state.detail || '';

            updateArtisticCounter();
            generatePrompt();
        }

        function loadPresets() {
            return JSON.parse(localStorage.getItem('prompt_presets') || '[]');
        }

        function savePresets(presets) {
            localStorage.setItem('prompt_presets', JSON.stringify(presets));
        }

        function renderPresets() {
            const presets = loadPresets();
            const list = document.getElementById('preset-list');
            if (presets.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 20px 0;">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø—Ä–µ—Å–µ—Ç–æ–≤</p>';
                return;
            }
            list.innerHTML = presets.map((preset, idx) => `
                <div class="preset-item">
                    <span class="preset-item-name">${preset.name}</span>
                    <div class="preset-item-actions">
                        <button class="preset-item-btn load" onclick="loadPreset(${idx})">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                        <button class="preset-item-btn delete" onclick="deletePreset(${idx})">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                </div>
            `).join('');
        }

        function savePresetDialog() {
            document.getElementById('preset-modal').style.display = 'block';
            document.getElementById('preset-name-input').value = '';
        }

        function closePresetModal() {
            document.getElementById('preset-modal').style.display = 'none';
        }

        function confirmSavePreset() {
            const name = document.getElementById('preset-name-input').value.trim();
            if (!name) {
                showNotification('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–∞!', 'warning');
                return;
            }

            const presets = loadPresets();
            const state = getCurrentState();
            presets.push({ name, state });
            savePresets(presets);
            renderPresets();
            closePresetModal();
            showNotification('üíæ –ü—Ä–µ—Å–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω!', 'success');
        }

        function loadPreset(index) {
            const presets = loadPresets();
            if (presets[index]) {
                applyState(presets[index].state);
                showNotification('‚úÖ –ü—Ä–µ—Å–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω!', 'success');
            }
        }

        function deletePreset(index) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–µ—Å–µ—Ç?')) {
                const presets = loadPresets();
                presets.splice(index, 1);
                savePresets(presets);
                renderPresets();
                showNotification('üóëÔ∏è –ü—Ä–µ—Å–µ—Ç —É–¥–∞–ª—ë–Ω', 'success');
            }
        }

        function exportPresets() {
            const presets = loadPresets();
            if (presets.length === 0) {
                showNotification('‚ö†Ô∏è –ù–µ—Ç –ø—Ä–µ—Å–µ—Ç–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞!', 'warning');
                return;
            }
            const json = JSON.stringify(presets, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'prompt_presets.json';
            a.click();
            showNotification('üì§ –ü—Ä–µ—Å–µ—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
        }

        function importPresetsDialog() {
            document.getElementById('import-modal').style.display = 'block';
            document.getElementById('import-json-input').value = '';
        }

        function closeImportModal() {
            document.getElementById('import-modal').style.display = 'none';
        }

        function confirmImportPresets() {
            const json = document.getElementById('import-json-input').value.trim();
            if (!json) {
                showNotification('‚ö†Ô∏è –í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ!', 'warning');
                return;
            }

            try {
                const imported = JSON.parse(json);
                if (!Array.isArray(imported)) throw new Error('Invalid format');
                const presets = loadPresets();
                presets.push(...imported);
                savePresets(presets);
                renderPresets();
                closeImportModal();
                showNotification('üì• –ü—Ä–µ—Å–µ—Ç—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
            } catch (error) {
                showNotification('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ JSON.', 'error');
            }
        }

        function generateRandomPrompt() {
            const randomExample = promptExamples[Math.floor(Math.random() * promptExamples.length)];
            inputEl.value = randomExample;

            const allStyles = Object.keys(styleDescriptions);
            const randomStyle = allStyles[Math.floor(Math.random() * allStyles.length)];
            const styleRadio = document.querySelector(`input[name="style"][value="${randomStyle}"]`);
            if (styleRadio) styleRadio.checked = true;

            document.querySelectorAll('.artistic-checkbox:checked').forEach(cb => cb.checked = false);
            const allArtistic = Object.keys(artisticTemplates);
            const randomCount = Math.floor(Math.random() * 3) + 1;
            const shuffled = allArtistic.sort(() => 0.5 - Math.random());
            shuffled.slice(0, randomCount).forEach(key => {
                const checkbox = document.querySelector(`.artistic-checkbox[value="${key}"]`);
                if (checkbox) checkbox.checked = true;
            });

            updateArtisticCounter();
            generatePrompt();
            showNotification('üé≤ –°–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!', 'success');
        }

        // === –ù–û–í–´–ô –ö–û–î: –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ===
        function initializeImageRecognition() {
            const uploadArea = document.getElementById('image-upload-area');
            const fileInput = document.getElementById('image-file-input');
            const analyzeBtn = document.getElementById('analyze-image-btn');

            uploadArea.addEventListener('click', () => fileInput.click());

            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragging');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragging');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragging');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleImageFile(files[0]);
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleImageFile(e.target.files[0]);
                }
            });

            analyzeBtn.addEventListener('click', analyzeImage);
        }

        function handleImageFile(file) {
            if (!file.type.startsWith('image/')) {
                showNotification('‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ!', 'warning');
                return;
            }

            currentImageFile = file;
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('image-preview').src = e.target.result;
                document.getElementById('image-preview-container').style.display = 'block';
                document.getElementById('image-prompt-result-container').style.display = 'none';
                updateAnalyzeButtonState();
            };
            reader.readAsDataURL(file);
        }

        function updateAnalyzeButtonState() {
            const token = document.getElementById('hf-token').value.trim();
            const btn = document.getElementById('analyze-image-btn');
            btn.disabled = !(currentImageFile && token);
        }

        async function analyzeImage() {
            const token = document.getElementById('hf-token').value.trim();
            if (!token || !currentImageFile) return;

            const btn = document.getElementById('analyze-image-btn');
            const btnText = document.getElementById('analyze-btn-text');
            btn.disabled = true;
            btnText.innerHTML = '<span class="loading-spinner"></span>–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...';

            try {
                const base64Image = await fileToBase64(currentImageFile);
                
                const response = await fetch('https://api-inference.huggingface.co/models/llava-hf/llava-1.5-7b-hf', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        inputs: {
                            question: "Describe this image in detail for AI image generation. Include: main subject, composition, colors, lighting, style, mood, and artistic elements. Focus on visual characteristics that would help recreate a similar image.",
                            image: base64Image
                        }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `API Error: ${response.status}`);
                }

                const data = await response.json();
                let answer = data[0]?.generated_text || data.answer || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ';
                
                const russianPrompt = await translateText(answer, 'ru');
                
                document.getElementById('image-prompt-result').textContent = russianPrompt;
                document.getElementById('image-prompt-result-container').style.display = 'block';
                showNotification('‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!', 'success');
            } catch (error) {
                console.error('Image analysis error:', error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ' + error.message, 'error');
            } finally {
                btn.disabled = false;
                btnText.innerHTML = 'üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';
            }
        }

        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result.split(',')[1]);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        function copyImagePrompt() {
            const text = document.getElementById('image-prompt-result').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('üìã –ü—Ä–æ–º–ø—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'success');
            });
        }
        // === –ö–û–ù–ï–¶ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞ ===

    </script>
</body>
</html>
